<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://wannesmalfait.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://wannesmalfait.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-05-21T10:33:41+00:00</updated><id>https://wannesmalfait.github.io/feed.xml</id><title type="html">blank</title><subtitle>Wannes Malfait&apos;s personal website. </subtitle><entry><title type="html">LaTeX compilation with GitHub actions</title><link href="https://wannesmalfait.github.io/blog/2024/github-latex-ci/" rel="alternate" type="text/html" title="LaTeX compilation with GitHub actions"/><published>2024-03-16T00:00:00+00:00</published><updated>2024-03-16T00:00:00+00:00</updated><id>https://wannesmalfait.github.io/blog/2024/github-latex-ci</id><content type="html" xml:base="https://wannesmalfait.github.io/blog/2024/github-latex-ci/"><![CDATA[<h2 id="why-i-wanted-to-compile-latex-code-with-github-actions">Why I wanted to compile LaTeX code with GitHub actions</h2> <p>Whenever I write a document in LaTeX, I set up a (local) git repository for version control. This lets me make big changes without having to worry about permanently deleting things that I might need in the future. By looking at the commit log, I can get a quick overview of what I was working on, after revisiting the document after some time. Because LaTeX generates a lot of extra files on compilation, I have a <code class="language-plaintext highlighter-rouge">.gitignore</code> file set up to essentially ignore everything that isn’t a <code class="language-plaintext highlighter-rouge">.bib</code> or a <code class="language-plaintext highlighter-rouge">.tex</code> file. Importantly, I ignore <code class="language-plaintext highlighter-rouge">.pdf</code> files. There are a couple of reasons for this:</p> <ol> <li>As a general rule of thumb, only source files should be included in a git repository. The compilation outputs can be recreated from the source files, and do not carry extra information.</li> <li>A <code class="language-plaintext highlighter-rouge">.pdf</code> file is relatively big. It can easily be 10 times the size of the source file.</li> <li>The binary data of the output <code class="language-plaintext highlighter-rouge">.pdf</code> file can change quite drastically, even after making small changes to <code class="language-plaintext highlighter-rouge">.tex</code> source. This makes it quite useless to use something like <code class="language-plaintext highlighter-rouge">git diff</code> directly on the PDF. Instead, a tool like <a href="https://ctan.org/pkg/latexdiff">latexdiff</a> should be used.</li> <li>I often only compile a small part of the whole document, to speed up compilation time. The output PDF’s do not reflect the “actual” state of the document, and shouldn’t be picked up by the version control.</li> </ol> <p>My only problem, so far, with this approach, was that I didn’t have an easy way to share the PDF with my supervisors. Every time I wanted to share a version, I had to compile the full document, and e-mail them the PDF. This is not terribly difficult to do, but it annoyed me slightly. Additionally, I wanted my supervisors to be able to view the latest version or a previous version at any time, without me having to spam them with e-mails.</p> <h2 id="my-solution">My solution</h2> <p>Setting up a simple GitHub action workflow, was surprisingly easy. A few searches on the web and some copy-pasting from README examples got me there. Here’s the code:</p> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .github/workflows/compile.yml</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Build LaTeX document</span>
<span class="na">on</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">push</span><span class="pi">]</span>
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build_latex</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">permissions</span><span class="pi">:</span>
      <span class="na">contents</span><span class="pi">:</span> <span class="s">write</span>
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Get current date</span>
        <span class="na">id</span><span class="pi">:</span> <span class="s">date</span> 
        <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span> <span class="c1"># You can change the time zone if needed</span>
            <span class="s">echo "date=$(TZ='Europe/Brussels' date +'%Y-%m-%d--%H-%M')" &gt;&gt; $GITHUB_ENV</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up Git repository</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v4</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Compile LaTeX document</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">xu-cheng/latex-action@v3</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">root_file</span><span class="pi">:</span> <span class="s">main.tex</span> <span class="c1"># Change to the name of your main file </span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload PDF file to new release</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">ncipollo/release-action@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">tag</span><span class="pi">:</span> <span class="s">${{ env.date }}</span>
          <span class="na">commit</span><span class="pi">:</span> <span class="s2">"</span><span class="s">main"</span> <span class="c1"># The name of the branch to commit to</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">${{ env.date }}</span>
          <span class="na">artifacts</span><span class="pi">:</span> <span class="s2">"</span><span class="s">main.pdf"</span> <span class="c1"># Make sure this is the same name as your main file</span>
</code></pre></div></div> <p>It works quite well, but there are some things which you might not like:</p> <ul> <li>This creates a new release on every push to the GitHub repository. I first tried just uploading the compiled PDF to an artifact instead of a release. The problem is that these can not be accessed without being logged in to GitHub, and they don’t have an easily accessible download link.</li> <li>I have not bothered to collect all the commit names into a change log for each release. That could be a possible improvement. Right now, the release just has the current date/time as its name and tag. This ensures it doesn’t accidentally get overwritten, but it could also be formatted a bit more nicely.</li> <li>The <code class="language-plaintext highlighter-rouge">latex-action</code> uses a full <code class="language-plaintext highlighter-rouge">texlive</code> environment. Currently, the full release workflow takes around 2 minutes to complete. This could probably be shortened by using a more minimal LaTeX environment.</li> </ul> <p>Over all, I’m happy with the result I got for the small amount of time I put into it.</p>]]></content><author><name></name></author><category term="GitHub"/><category term="LaTeX"/><category term="programming"/><summary type="html"><![CDATA[Setting up GitHub actions to compile LaTeX documents on push]]></summary></entry></feed>